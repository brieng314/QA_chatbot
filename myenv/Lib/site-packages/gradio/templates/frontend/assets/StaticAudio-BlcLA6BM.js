import{p as v,i as Y,d as qe,r as at,e as Ee,v as lt,c as Ke,a as $e,b as je}from"./i18n-CLA-aXfX.js";import{n as Ae,b as D,p as Ve,X as Oe,U as le,c as Ie,g,ac as et,i as t,m as A,l as $,d as k,a as Ne,f as ie,j as L,t as Pe,e as K,h as V,r as I,s as W,Q as J,k as tt,R as it,az as se,V as xe}from"./index-zQcUQ9m1.js";import{b as Le}from"./misc-snWqx6W0.js";import{f as Te,u as ut}from"./utils.svelte-DtXXSlyN.js";/* empty css                                                        */import"./MarkdownCode.svelte_svelte_type_style_lang-C7vd_kT1.js";import{B as dt}from"./BlockLabel-BmXTkHTt.js";import{D as ct}from"./DownloadLink-DaQ_7WnR.js";import{I as ht}from"./IconButton-B7IBJBO5.js";import{E as nt}from"./Empty-BZ_-KNsK.js";import{S as vt}from"./ShareButton-_eP1IUQf.js";import{D as gt}from"./Download-X4TzKHZY.js";import{M as Qe}from"./Music-Dyf3R8ai.js";import{I as mt}from"./IconButtonWrapper-dc02OfMv.js";import{g as De,s as Ge,u as ft,H as Se,p as pt,M as _t}from"./MinimalAudioPlayer-CX04FWPU.js";import{P as bt,T as wt}from"./Trim-DvpdrBte.js";import{P as yt}from"./Play-BMqghMO0.js";import{U as Ct}from"./Undo-B0i5SYxj.js";var kt=Ae('<svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" stroke-width="1.5" viewBox="0 0 24 24" color="currentColor"><path stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" d="M21.044 5.704a.6.6 0 0 1 .956.483v11.626a.6.6 0 0 1-.956.483l-7.889-5.813a.6.6 0 0 1 0-.966l7.89-5.813ZM10.044 5.704a.6.6 0 0 1 .956.483v11.626a.6.6 0 0 1-.956.483l-7.888-5.813a.6.6 0 0 1 0-.966l7.888-5.813Z"></path></svg>');function Et(b){var e=kt();D(b,e)}var xt=Ae('<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather feather-closed-caption"><rect x="2" y="6" width="20" height="12" rx="2" ry="2"></rect><text x="12" y="15" font-family="sans-serif" font-size="8" font-weight="bold" fill="currentColor" stroke="none" text-anchor="middle">CC</text></svg>');function Lt(b){var e=xt();D(b,e)}var Rt=Ae('<svg xmlns="http://www.w3.org/2000/svg" width="24px" height="24px" fill="currentColor" stroke-width="1.5" viewBox="0 0 24 24" color="currentColor"><path stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" d="M2.956 5.704A.6.6 0 0 0 2 6.187v11.626a.6.6 0 0 0 .956.483l7.889-5.813a.6.6 0 0 0 0-.966l-7.89-5.813ZM13.956 5.704a.6.6 0 0 0-.956.483v11.626a.6.6 0 0 0 .956.483l7.889-5.813a.6.6 0 0 0 0-.966l-7.89-5.813Z"></path></svg>');function zt(b){var e=Rt();D(b,e)}var Mt=Ae('<svg width="100%" height="100%" viewBox="0 0 24 24" stroke-width="1.5" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="currentColor" color="currentColor"><title>Low volume</title><path d="M19.5 7.5C19.5 7.5 21 9 21 11.5C21 14 19.5 15.5 19.5 15.5" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M2 13.8571V10.1429C2 9.03829 2.89543 8.14286 4 8.14286H6.9C7.09569 8.14286 7.28708 8.08544 7.45046 7.97772L13.4495 4.02228C14.1144 3.5839 15 4.06075 15 4.85714V19.1429C15 19.9392 14.1144 20.4161 13.4495 19.9777L7.45046 16.0223C7.28708 15.9146 7.09569 15.8571 6.9 15.8571H4C2.89543 15.8571 2 14.9617 2 13.8571Z" stroke-width="1.5"></path></svg>');function Dt(b){var e=Mt();D(b,e)}var St=Ae('<svg width="100%" height="100%" viewBox="0 0 24 24" stroke-width="1.5" fill="none" stroke="currentColor" xmlns="http://www.w3.org/2000/svg" color="currentColor"><title>High volume</title><path d="M1 13.8571V10.1429C1 9.03829 1.89543 8.14286 3 8.14286H5.9C6.09569 8.14286 6.28708 8.08544 6.45046 7.97772L12.4495 4.02228C13.1144 3.5839 14 4.06075 14 4.85714V19.1429C14 19.9392 13.1144 20.4161 12.4495 19.9777L6.45046 16.0223C6.28708 15.9146 6.09569 15.8571 5.9 15.8571H3C1.89543 15.8571 1 14.9617 1 13.8571Z" stroke-width="1.5"></path><path d="M17.5 7.5C17.5 7.5 19 9 19 11.5C19 14 17.5 15.5 17.5 15.5" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M20.5 4.5C20.5 4.5 23 7 23 11.5C23 16 20.5 18.5 20.5 18.5" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg>');function Pt(b){var e=St();D(b,e)}var At=Ae('<svg width="100%" height="100%" viewBox="0 0 24 24" stroke-width="1.5" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="currentColor" color="currentColor"><title>Muted volume</title><g clip-path="url(#clip0_3173_16686)"><path d="M18 14L20.0005 12M22 10L20.0005 12M20.0005 12L18 10M20.0005 12L22 14" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M2 13.8571V10.1429C2 9.03829 2.89543 8.14286 4 8.14286H6.9C7.09569 8.14286 7.28708 8.08544 7.45046 7.97772L13.4495 4.02228C14.1144 3.5839 15 4.06075 15 4.85714V19.1429C15 19.9392 14.1144 20.4161 13.4495 19.9777L7.45046 16.0223C7.28708 15.9146 7.09569 15.8571 6.9 15.8571H4C2.89543 15.8571 2 14.9617 2 13.8571Z" stroke-width="1.5"></path></g><defs><clipPath id="clip0_3173_16686"><rect width="24" height="24" fill="white"></rect></clipPath></defs></svg>');function Bt(b){var e=At();D(b,e)}class rt{constructor(){this.listeners={}}on(e,i,n){if(this.listeners[e]||(this.listeners[e]=new Set),n?.once){const r=(...l)=>{this.un(e,r),i(...l)};return this.listeners[e].add(r),()=>this.un(e,r)}return this.listeners[e].add(i),()=>this.un(e,i)}un(e,i){var n;(n=this.listeners[e])===null||n===void 0||n.delete(i)}once(e,i){return this.on(e,i,{once:!0})}unAll(){this.listeners={}}emit(e,...i){this.listeners[e]&&this.listeners[e].forEach((n=>n(...i)))}}class Tt extends rt{constructor(e){super(),this.subscriptions=[],this.isDestroyed=!1,this.options=e}onInit(){}_init(e){this.isDestroyed&&(this.subscriptions=[],this.isDestroyed=!1),this.wavesurfer=e,this.onInit()}destroy(){this.emit("destroy"),this.subscriptions.forEach((e=>e())),this.subscriptions=[],this.isDestroyed=!0,this.wavesurfer=void 0}}function Ue(b,e,i,n,r=3,l=0,u=100){if(!b)return()=>{};const h=matchMedia("(pointer: coarse)").matches;let c=()=>{};const d=f=>{if(f.button!==l)return;f.preventDefault(),f.stopPropagation();let E=f.clientX,w=f.clientY,_=!1;const R=Date.now(),X=C=>{if(C.preventDefault(),C.stopPropagation(),h&&Date.now()-R<u)return;const o=C.clientX,m=C.clientY,B=o-E,U=m-w;if(_||Math.abs(B)>r||Math.abs(U)>r){const Z=b.getBoundingClientRect(),{left:q,top:z}=Z;_||(i?.(E-q,w-z),_=!0),e(B,U,o-q,m-z),E=o,w=m}},j=C=>{if(_){const o=C.clientX,m=C.clientY,B=b.getBoundingClientRect(),{left:U,top:Z}=B;n?.(o-U,m-Z)}c()},x=C=>{C.relatedTarget&&C.relatedTarget!==document.documentElement||j(C)},p=C=>{_&&(C.stopPropagation(),C.preventDefault())},F=C=>{_&&C.preventDefault()};document.addEventListener("pointermove",X),document.addEventListener("pointerup",j),document.addEventListener("pointerout",x),document.addEventListener("pointercancel",x),document.addEventListener("touchmove",F,{passive:!1}),document.addEventListener("click",p,{capture:!0}),c=()=>{document.removeEventListener("pointermove",X),document.removeEventListener("pointerup",j),document.removeEventListener("pointerout",x),document.removeEventListener("pointercancel",x),document.removeEventListener("touchmove",F),setTimeout((()=>{document.removeEventListener("click",p,{capture:!0})}),10)}};return b.addEventListener("pointerdown",d),()=>{c(),b.removeEventListener("pointerdown",d)}}function st(b,e){const i=e.xmlns?document.createElementNS(e.xmlns,b):document.createElement(b);for(const[n,r]of Object.entries(e))if(n==="children"&&r)for(const[l,u]of Object.entries(r))u instanceof Node?i.appendChild(u):typeof u=="string"?i.appendChild(document.createTextNode(u)):i.appendChild(st(l,u));else n==="style"?Object.assign(i.style,r):n==="textContent"?i.textContent=r:i.setAttribute(n,r.toString());return i}function He(b,e,i){const n=st(b,e||{});return i?.appendChild(n),n}class Je extends rt{constructor(e,i,n=0){var r,l,u,h,c,d,f,E,w,_;super(),this.totalDuration=i,this.numberOfChannels=n,this.element=null,this.minLength=0,this.maxLength=1/0,this.contentEditable=!1,this.subscriptions=[],this.updatingSide=void 0,this.isRemoved=!1,this.subscriptions=[],this.id=e.id||`region-${Math.random().toString(32).slice(2)}`,this.start=this.clampPosition(e.start),this.end=this.clampPosition((r=e.end)!==null&&r!==void 0?r:e.start),this.drag=(l=e.drag)===null||l===void 0||l,this.resize=(u=e.resize)===null||u===void 0||u,this.resizeStart=(h=e.resizeStart)===null||h===void 0||h,this.resizeEnd=(c=e.resizeEnd)===null||c===void 0||c,this.color=(d=e.color)!==null&&d!==void 0?d:"rgba(0, 0, 0, 0.1)",this.minLength=(f=e.minLength)!==null&&f!==void 0?f:this.minLength,this.maxLength=(E=e.maxLength)!==null&&E!==void 0?E:this.maxLength,this.channelIdx=(w=e.channelIdx)!==null&&w!==void 0?w:-1,this.contentEditable=(_=e.contentEditable)!==null&&_!==void 0?_:this.contentEditable,this.element=this.initElement(),this.setContent(e.content),this.setPart(),this.renderPosition(),this.initMouseEvents()}clampPosition(e){return Math.max(0,Math.min(this.totalDuration,e))}setPart(){var e;const i=this.start===this.end;(e=this.element)===null||e===void 0||e.setAttribute("part",`${i?"marker":"region"} ${this.id}`)}addResizeHandles(e){const i={position:"absolute",zIndex:"2",width:"6px",height:"100%",top:"0",cursor:"ew-resize",wordBreak:"keep-all"},n=He("div",{part:"region-handle region-handle-left",style:Object.assign(Object.assign({},i),{left:"0",borderLeft:"2px solid rgba(0, 0, 0, 0.5)",borderRadius:"2px 0 0 2px"})},e),r=He("div",{part:"region-handle region-handle-right",style:Object.assign(Object.assign({},i),{right:"0",borderRight:"2px solid rgba(0, 0, 0, 0.5)",borderRadius:"0 2px 2px 0"})},e);this.subscriptions.push(Ue(n,(l=>this.onResize(l,"start")),(()=>null),(()=>this.onEndResizing("start")),1),Ue(r,(l=>this.onResize(l,"end")),(()=>null),(()=>this.onEndResizing("end")),1))}removeResizeHandles(e){const i=e.querySelector('[part*="region-handle-left"]'),n=e.querySelector('[part*="region-handle-right"]');i&&e.removeChild(i),n&&e.removeChild(n)}initElement(){if(this.isRemoved)return null;const e=this.start===this.end;let i=0,n=100;this.channelIdx>=0&&this.numberOfChannels>0&&this.channelIdx<this.numberOfChannels&&(n=100/this.numberOfChannels,i=n*this.channelIdx);const r=He("div",{style:{position:"absolute",top:`${i}%`,height:`${n}%`,backgroundColor:e?"none":this.color,borderLeft:e?"2px solid "+this.color:"none",borderRadius:"2px",boxSizing:"border-box",transition:"background-color 0.2s ease",cursor:this.drag?"grab":"default",pointerEvents:"all"}});return!e&&this.resize&&this.addResizeHandles(r),r}renderPosition(){if(!this.element)return;const e=this.start/this.totalDuration,i=(this.totalDuration-this.end)/this.totalDuration;this.element.style.left=100*e+"%",this.element.style.right=100*i+"%"}toggleCursor(e){var i;this.drag&&(!((i=this.element)===null||i===void 0)&&i.style)&&(this.element.style.cursor=e?"grabbing":"grab")}initMouseEvents(){const{element:e}=this;e&&(e.addEventListener("click",(i=>this.emit("click",i))),e.addEventListener("mouseenter",(i=>this.emit("over",i))),e.addEventListener("mouseleave",(i=>this.emit("leave",i))),e.addEventListener("dblclick",(i=>this.emit("dblclick",i))),e.addEventListener("pointerdown",(()=>this.toggleCursor(!0))),e.addEventListener("pointerup",(()=>this.toggleCursor(!1))),this.subscriptions.push(Ue(e,(i=>this.onMove(i)),(()=>this.toggleCursor(!0)),(()=>{this.toggleCursor(!1),this.drag&&this.emit("update-end")}))),this.contentEditable&&this.content&&(this.contentClickListener=i=>this.onContentClick(i),this.contentBlurListener=()=>this.onContentBlur(),this.content.addEventListener("click",this.contentClickListener),this.content.addEventListener("blur",this.contentBlurListener)))}_onUpdate(e,i,n){var r;if(!(!((r=this.element)===null||r===void 0)&&r.parentElement))return;const{width:l}=this.element.parentElement.getBoundingClientRect(),u=e/l*this.totalDuration;let h=i&&i!=="start"?this.start:this.start+u,c=i&&i!=="end"?this.end:this.end+u;const d=n!==void 0;d&&this.updatingSide&&this.updatingSide!==i&&(this.updatingSide==="start"?h=n:c=n),h=Math.max(0,h),c=Math.min(this.totalDuration,c);const f=c-h;this.updatingSide=i;const E=f>=this.minLength&&f<=this.maxLength;h<=c&&(E||d)&&(this.start=h,this.end=c,this.renderPosition(),this.emit("update",i))}onMove(e){this.drag&&this._onUpdate(e)}onResize(e,i){this.resize&&(this.resizeStart||i!=="start")&&(this.resizeEnd||i!=="end")&&this._onUpdate(e,i)}onEndResizing(e){this.resize&&(this.emit("update-end",e),this.updatingSide=void 0)}onContentClick(e){e.stopPropagation(),e.target.focus(),this.emit("click",e)}onContentBlur(){this.emit("update-end")}_setTotalDuration(e){this.totalDuration=e,this.renderPosition()}play(e){this.emit("play",e&&this.end!==this.start?this.end:void 0)}getContent(e=!1){var i;return e?this.content||void 0:this.element instanceof HTMLElement?((i=this.content)===null||i===void 0?void 0:i.innerHTML)||void 0:""}setContent(e){var i;if(this.element)if(this.content&&this.contentEditable&&(this.contentClickListener&&this.content.removeEventListener("click",this.contentClickListener),this.contentBlurListener&&this.content.removeEventListener("blur",this.contentBlurListener)),(i=this.content)===null||i===void 0||i.remove(),e){if(typeof e=="string"){const n=this.start===this.end;this.content=He("div",{style:{padding:`0.2em ${n?.2:.4}em`,display:"inline-block"},textContent:e})}else this.content=e;this.contentEditable&&(this.content.contentEditable="true",this.contentClickListener=n=>this.onContentClick(n),this.contentBlurListener=()=>this.onContentBlur(),this.content.addEventListener("click",this.contentClickListener),this.content.addEventListener("blur",this.contentBlurListener)),this.content.setAttribute("part","region-content"),this.element.appendChild(this.content),this.emit("content-changed")}else this.content=void 0}setOptions(e){var i,n;if(this.element){if(e.color&&(this.color=e.color,this.element.style.backgroundColor=this.color),e.drag!==void 0&&(this.drag=e.drag,this.element.style.cursor=this.drag?"grab":"default"),e.start!==void 0||e.end!==void 0){const r=this.start===this.end;this.start=this.clampPosition((i=e.start)!==null&&i!==void 0?i:this.start),this.end=this.clampPosition((n=e.end)!==null&&n!==void 0?n:r?this.start:this.end),this.renderPosition(),this.setPart()}if(e.content&&this.setContent(e.content),e.id&&(this.id=e.id,this.setPart()),e.resize!==void 0&&e.resize!==this.resize){const r=this.start===this.end;this.resize=e.resize,this.resize&&!r?this.addResizeHandles(this.element):this.removeResizeHandles(this.element)}e.resizeStart!==void 0&&(this.resizeStart=e.resizeStart),e.resizeEnd!==void 0&&(this.resizeEnd=e.resizeEnd)}}remove(){this.isRemoved=!0,this.emit("remove"),this.subscriptions.forEach((e=>e())),this.element&&(this.element.remove(),this.element=null)}}class Ze extends Tt{constructor(e){super(e),this.regions=[],this.regionsContainer=this.initRegionsContainer()}static create(e){return new Ze(e)}onInit(){if(!this.wavesurfer)throw Error("WaveSurfer is not initialized");this.wavesurfer.getWrapper().appendChild(this.regionsContainer),this.subscriptions.push(this.wavesurfer.on("ready",(i=>{this.regions.forEach((n=>n._setTotalDuration(i)))})));let e=[];this.subscriptions.push(this.wavesurfer.on("timeupdate",(i=>{const n=this.regions.filter((r=>r.start<=i&&(r.end===r.start?r.start+.05:r.end)>=i));n.forEach((r=>{e.includes(r)||this.emit("region-in",r)})),e.forEach((r=>{n.includes(r)||this.emit("region-out",r)})),e=n})))}initRegionsContainer(){return He("div",{part:"regions-container",style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",zIndex:"5",pointerEvents:"none"}})}getRegions(){return this.regions}avoidOverlapping(e){e.content&&setTimeout((()=>{const i=e.content,n=i.getBoundingClientRect(),r=this.regions.map((l=>{if(l===e||!l.content)return 0;const u=l.content.getBoundingClientRect();return n.left<u.left+u.width&&u.left<n.left+n.width?u.height:0})).reduce(((l,u)=>l+u),0);i.style.marginTop=`${r}px`}),10)}adjustScroll(e){var i,n;if(!e.element)return;const r=(n=(i=this.wavesurfer)===null||i===void 0?void 0:i.getWrapper())===null||n===void 0?void 0:n.parentElement;if(!r)return;const{clientWidth:l,scrollWidth:u}=r;if(u<=l)return;const h=r.getBoundingClientRect(),c=e.element.getBoundingClientRect(),d=c.left-h.left,f=c.right-h.left;d<0?r.scrollLeft+=d:f>l&&(r.scrollLeft+=f-l)}virtualAppend(e,i,n){const r=()=>{if(!this.wavesurfer)return;const l=this.wavesurfer.getWidth(),u=this.wavesurfer.getScroll(),h=i.clientWidth,c=this.wavesurfer.getDuration(),d=Math.round(e.start/c*h),f=d+(Math.round((e.end-e.start)/c*h)||1)>u&&d<u+l;f&&!n.parentElement?i.appendChild(n):!f&&n.parentElement&&n.remove()};setTimeout((()=>{if(!this.wavesurfer||!e.element)return;r();const l=this.wavesurfer.on("scroll",r),u=this.wavesurfer.on("zoom",r);this.subscriptions.push(l,u),e.once("remove",(()=>{l(),u()}))}),0)}saveRegion(e){if(!e.element)return;this.virtualAppend(e,this.regionsContainer,e.element),this.avoidOverlapping(e),this.regions.push(e);const i=[e.on("update",(n=>{n||this.adjustScroll(e),this.emit("region-update",e,n)})),e.on("update-end",(n=>{this.avoidOverlapping(e),this.emit("region-updated",e,n)})),e.on("play",(n=>{var r;(r=this.wavesurfer)===null||r===void 0||r.play(e.start,n)})),e.on("click",(n=>{this.emit("region-clicked",e,n)})),e.on("dblclick",(n=>{this.emit("region-double-clicked",e,n)})),e.on("content-changed",(()=>{this.emit("region-content-changed",e)})),e.once("remove",(()=>{i.forEach((n=>n())),this.regions=this.regions.filter((n=>n!==e)),this.emit("region-removed",e)}))];this.subscriptions.push(...i),this.emit("region-created",e)}addRegion(e){var i,n;if(!this.wavesurfer)throw Error("WaveSurfer is not initialized");const r=this.wavesurfer.getDuration(),l=(n=(i=this.wavesurfer)===null||i===void 0?void 0:i.getDecodedData())===null||n===void 0?void 0:n.numberOfChannels,u=new Je(e,r,l);return this.emit("region-initialized",u),r?this.saveRegion(u):this.subscriptions.push(this.wavesurfer.once("ready",(h=>{u._setTotalDuration(h),this.saveRegion(u)}))),u}enableDragSelection(e,i=3){var n;const r=(n=this.wavesurfer)===null||n===void 0?void 0:n.getWrapper();if(!(r&&r instanceof HTMLElement))return()=>{};let l=null,u=0,h=0;return Ue(r,((c,d,f)=>{l&&l._onUpdate(c,f>u?"end":"start",h)}),(c=>{var d,f;if(u=c,!this.wavesurfer)return;const E=this.wavesurfer.getDuration(),w=(f=(d=this.wavesurfer)===null||d===void 0?void 0:d.getDecodedData())===null||f===void 0?void 0:f.numberOfChannels,{width:_}=this.wavesurfer.getWrapper().getBoundingClientRect();h=u/_*E;const R=c/_*E,X=(c+5)/_*E;l=new Je(Object.assign(Object.assign({},e),{start:R,end:X}),E,w),this.emit("region-initialized",l),l.element&&this.regionsContainer.appendChild(l.element)}),(()=>{l&&(this.saveRegion(l),l.updatingSide=void 0,l=null)}),i)}clearRegions(){this.regions.slice().forEach((e=>e.remove())),this.regions=[]}destroy(){this.clearRegions(),super.destroy(),this.regionsContainer.remove()}}function jt(b,e){Ve(e,!1);let i=v(e,"currentVolume",12);var n={get currentVolume(){return i()},set currentVolume(c){i(c),g()}},r=Oe(),l=le(r);{var u=c=>{Bt(c)},h=c=>{var d=Oe(),f=le(d);{var E=_=>{Dt(_)},w=_=>{var R=Oe(),X=le(R);{var j=x=>{Pt(x)};Y(X,x=>{i()>=.5&&x(j)},!0)}D(_,R)};Y(f,_=>{i()<.5?_(E):_(w,!1)},!0)}D(c,d)};Y(l,c=>{i()==0?c(u):c(h,!1)})}return D(b,r),Ie(n)}var Ht=ie('<input id="volume" class="volume-slider svelte-c0ird4" type="range" min="0" max="1" step="0.01"/>');function Ot(b,e){Ve(e,!1);let i=v(e,"currentVolume",12,1),n=v(e,"show_volume_slider",12,!1),r=v(e,"waveform",12),l=A();et(()=>{u()});const u=()=>{let d=t(l);d&&(d.style.background=`linear-gradient(to right, var(--color-accent) ${i()*100}%, var(--neutral-400) ${i()*100}%)`)};$(()=>k(i()),()=>{i(),u()}),Ne();var h={get currentVolume(){return i()},set currentVolume(d){i(d),g()},get show_volume_slider(){return n()},set show_volume_slider(d){n(d),g()},get waveform(){return r()},set waveform(d){r(d),g()}};qe();var c=Ht();return at(c),Ee(c,d=>L(l,d),()=>t(l)),Pe(()=>lt(c,i())),K("focusout",c,()=>n(!1)),K("input",c,d=>{d.target instanceof HTMLInputElement&&(i(parseFloat(d.target.value)),r()?.setVolume(i()))}),D(b,c),Ie(h)}var Vt=ie('<button class="action icon cc-button svelte-72dh9g" data-testid="subtitles-toggle"><!></button>'),It=ie('<button class="action icon svelte-72dh9g" aria-label="Reset audio"><!></button>'),Wt=ie('<button class="action icon svelte-72dh9g" aria-label="Trim audio to selection"><!></button>'),Ft=ie('<button class="text-button svelte-72dh9g">Trim</button> <button class="text-button svelte-72dh9g">Cancel</button>',1),Ut=ie("<!> <!>",1),Zt=ie('<div class="controls svelte-72dh9g" data-testid="waveform-controls"><div class="control-wrapper svelte-72dh9g"><button class="action icon volume svelte-72dh9g" aria-label="Adjust volume"><!></button> <!> <button><span> </span></button></div> <div class="play-pause-wrapper svelte-72dh9g"><button class="rewind icon svelte-72dh9g"><!></button> <button class="play-pause-button icon svelte-72dh9g"><!></button> <button class="skip icon svelte-72dh9g"><!></button></div> <div class="settings-wrapper svelte-72dh9g"><!> <!></div></div>');function qt(b,e){Ve(e,!1);let i=v(e,"waveform",12),n=v(e,"audio_duration",12),r=v(e,"i18n",12),l=v(e,"playing",12),u=v(e,"show_redo",12,!1),h=v(e,"interactive",12,!1),c=v(e,"handle_trim_audio",12),d=v(e,"mode",12,""),f=v(e,"container",12),E=v(e,"handle_reset_value",12),w=v(e,"waveform_options",28,()=>({})),_=v(e,"trim_region_settings",28,()=>({})),R=v(e,"show_volume_slider",12,!1),X=v(e,"editable",12,!0),j=v(e,"subtitles_toggle",12,!0),x=v(e,"show_subtitles",12,!1),p=v(e,"trimDuration",12,0),F=[.5,1,1.5,2],C=A(F[1]),o=A(null),m=A(null),B=A(),U=A(),Z=A(""),q=A(1);const z=()=>{t(o)&&(L(m,t(o)?.addRegion({start:n()/4,end:n()/2,..._()})),p(t(m).end-t(m).start))},ue=()=>{if(i()&&t(o)&&t(m)){const s=t(m).start,M=t(m).end;c()(s,M),d(""),L(m,null)}},de=()=>{t(o)?.getRegions().forEach(s=>{s.remove()}),t(o)?.clearRegions()},ce=()=>{de(),d()==="edit"?d(""):(d("edit"),z())},H=()=>{j(!j())},_e=(s,M)=>{let Q,ae;t(m)&&(s==="left"?M==="ArrowLeft"?(Q=t(m).start-.05,ae=t(m).end):(Q=t(m).start+.05,ae=t(m).end):M==="ArrowLeft"?(Q=t(m).start,ae=t(m).end-.05):(Q=t(m).start,ae=t(m).end+.05),t(m).setOptions({start:Q,end:ae}),p(t(m).end-t(m).start))};$(()=>(k(f()),k(i()),Ze),()=>{L(o,f()&&i()?i().registerPlugin(Ze.create()):null)}),$(()=>t(o),()=>{t(o)?.on("region-out",s=>{s.play()})}),$(()=>t(o),()=>{t(o)?.on("region-updated",s=>{p(s.end-s.start)})}),$(()=>t(o),()=>{t(o)?.on("region-clicked",(s,M)=>{M.stopPropagation(),L(m,s),s.play()})}),$(()=>(t(m),k(f()),t(U),t(B),t(o)),()=>{if(t(m)){const s=f().children[0].shadowRoot;L(U,s.querySelector('[data-resize="right"]')),L(B,s.querySelector('[data-resize="left"]')),t(B)&&t(U)&&(t(B).setAttribute("role","button"),t(U).setAttribute("role","button"),t(B)?.setAttribute("aria-label","Drag to adjust start time"),t(U)?.setAttribute("aria-label","Drag to adjust end time"),t(B)?.setAttribute("tabindex","0"),t(U)?.setAttribute("tabindex","0"),t(B).addEventListener("focus",()=>{t(o)&&L(Z,"left")}),t(U).addEventListener("focus",()=>{t(o)&&L(Z,"right")}))}}),$(()=>(t(o),t(Z)),()=>{t(o)&&window.addEventListener("keydown",s=>{s.key==="ArrowLeft"?_e(t(Z),"ArrowLeft"):s.key==="ArrowRight"&&_e(t(Z),"ArrowRight")})}),Ne();var Re={get waveform(){return i()},set waveform(s){i(s),g()},get audio_duration(){return n()},set audio_duration(s){n(s),g()},get i18n(){return r()},set i18n(s){r(s),g()},get playing(){return l()},set playing(s){l(s),g()},get show_redo(){return u()},set show_redo(s){u(s),g()},get interactive(){return h()},set interactive(s){h(s),g()},get handle_trim_audio(){return c()},set handle_trim_audio(s){c(s),g()},get mode(){return d()},set mode(s){d(s),g()},get container(){return f()},set container(s){f(s),g()},get handle_reset_value(){return E()},set handle_reset_value(s){E(s),g()},get waveform_options(){return w()},set waveform_options(s){w(s),g()},get trim_region_settings(){return _()},set trim_region_settings(s){_(s),g()},get show_volume_slider(){return R()},set show_volume_slider(s){R(s),g()},get editable(){return X()},set editable(s){X(s),g()},get subtitles_toggle(){return j()},set subtitles_toggle(s){j(s),g()},get show_subtitles(){return x()},set show_subtitles(s){x(s),g()},get trimDuration(){return p()},set trimDuration(s){p(s),g()}};qe();var be=Zt(),we=V(be),he=V(we);let ee;var ne=V(he);jt(ne,{get currentVolume(){return t(q)}}),I(he);var ye=W(he,2);{var ze=s=>{Ot(s,{get waveform(){return i()},get currentVolume(){return t(q)},set currentVolume(M){L(q,M)},get show_volume_slider(){return R()},set show_volume_slider(M){R(M)},$$legacy:!0})};Y(ye,s=>{R()&&s(ze)})}var fe=W(ye,2);let Ce;var ve=V(fe),We=V(ve);I(ve),I(fe),I(we);var Be=W(we,2),ke=V(Be),Xe=V(ke);Et(Xe),I(ke);var a=W(ke,2),y=V(a);{var T=s=>{bt(s)},S=s=>{yt(s)};Y(y,s=>{l()?s(T):s(S,!1)})}I(a);var O=W(a,2),re=V(O);zt(re),I(O),I(Be);var te=W(Be,2),ge=V(te);{var Me=s=>{var M=Vt(),Q=V(M);Lt(Q),I(M),Pe(()=>Ke(M,`color: ${j()?"var(--color-accent)":"var(--neutral-400)"}`)),K("click",M,H),D(s,M)};Y(ge,s=>{x()&&s(Me)})}var oe=W(ge,2);{var me=s=>{var M=Ut(),Q=le(M);{var ae=P=>{var G=It(),pe=V(G);Ct(pe),I(G),K("click",G,()=>{E()(),de(),d("")}),D(P,G)};Y(Q,P=>{u()&&d()===""&&P(ae)})}var Fe=W(Q,2);{var Ye=P=>{var G=Wt(),pe=V(G);wt(pe),I(G),K("click",G,ce),D(P,G)},N=P=>{var G=Ft(),pe=le(G),ot=W(pe,2);K("click",pe,ue),K("click",ot,ce),D(P,G)};Y(Fe,P=>{d()===""?P(Ye):P(N,!1)})}D(s,M)};Y(oe,s=>{X()&&h()&&s(me)})}return I(te),I(be),Pe((s,M,Q,ae)=>{ee=Ke(he,"",ee,{color:R()?"var(--color-accent)":"var(--neutral-400)"}),Ce=$e(fe,1,"playback icon svelte-72dh9g",null,Ce,{hidden:R()}),je(fe,"aria-label",s),tt(We,`${t(C)??""}x`),je(ke,"aria-label",M),je(a,"aria-label",Q),je(O,"aria-label",`Skip forward by ${ae??""} seconds`)},[()=>(t(C),J(()=>`Adjust playback speed to ${F[(F.indexOf(t(C))+1)%F.length]}x`)),()=>(k(De),k(n()),k(w()),J(()=>`Skip backwards by ${De(n(),w().skip_length)} seconds`)),()=>(k(l()),k(r()),J(()=>l()?r()("audio.pause"):r()("audio.play"))),()=>(k(De),k(n()),k(w()),J(()=>De(n(),w().skip_length)))]),K("click",he,()=>R(!R())),K("click",fe,()=>{L(C,F[(F.indexOf(t(C))+1)%F.length]),i()?.setPlaybackRate(t(C))}),K("click",ke,()=>i()?.skip(De(n(),w().skip_length)*-1)),K("click",a,()=>i()?.playPause()),K("click",O,()=>i()?.skip(De(n(),w().skip_length))),D(b,be),Ie(Re)}var Nt=ie('<time id="trim-duration" class="svelte-1ffmt2w"> </time>'),Xt=ie('<div class="component-wrapper svelte-1ffmt2w"><div class="waveform-container svelte-1ffmt2w"><div id="waveform" class="svelte-1ffmt2w"></div></div> <div class="timestamps svelte-1ffmt2w"><time id="time" class="svelte-1ffmt2w">0:00</time> <div><!> <time id="duration" class="svelte-1ffmt2w">0:00</time></div></div> <div class="subtitle-display svelte-1ffmt2w" data-testid="subtitle-display"></div> <!></div>'),Yt=ie('<audio controls preload="metadata"></audio> <!>',1);function Kt(b,e){Ve(e,!1);const i=A(),n=A();let r=v(e,"value",12,null),l=v(e,"subtitles",12,null),u=v(e,"label",12),h=v(e,"i18n",12),c=v(e,"dispatch_blob",12,()=>Promise.resolve()),d=v(e,"interactive",12,!1),f=v(e,"editable",12,!0),E=v(e,"trim_region_settings",28,()=>({})),w=v(e,"waveform_settings",12),_=v(e,"waveform_options",12),R=v(e,"mode",12,""),X=v(e,"loop",12),j=v(e,"handle_reset_value",12,()=>{}),x=A(),p=A(),F=A(),C=A(!1),o=A(),m=A(),B=A(),U=A(),Z=A(0),q=A(!1),z=A(),ue=!1,de=A(!0),ce=[];const H=it(),_e=()=>{L(p,ft.create({container:t(x),...w()})),l()&&t(p)&&(t(de)?he(t(p),l()):ee()),r()?.url&&t(p)&&t(p).load(r()?.url),t(p)?.on("decode",a=>{L(U,a),t(B)&&se(B,t(B).textContent=Te(a))}),t(p)?.on("timeupdate",a=>t(m)&&se(m,t(m).textContent=Te(a))),t(p)?.on("interaction",()=>{const a=t(p)?.getCurrentTime()||0;t(m)&&se(m,t(m).textContent=Te(a))}),t(p)?.on("ready",()=>{w().autoplay?t(p)?.play():t(p)?.stop()}),t(p)?.on("finish",()=>{X()?t(p)?.play():(L(C,!1),H("stop"))}),t(p)?.on("pause",()=>{L(C,!1),H("pause")}),t(p)?.on("play",()=>{L(C,!0),H("play")}),t(p)?.on("load",()=>{H("load")})},Re=async(a,y)=>{R("");const T=t(p)?.getDecodedData();T&&await pt(T,a,y,w().sampleRate).then(async S=>{await c()([S],"change"),t(p)?.destroy(),se(x,t(x).innerHTML="")}),H("edit")};async function be(a){ue=!1,_().show_recording_waveform?t(p)?.load(a):t(z)&&se(z,t(z).src=a)}function we(a){if(!(!a||!a.is_stream||!a.url))if(Se.isSupported()&&!ue){const y=new Se({maxBufferLength:1,maxMaxBufferLength:1,lowLatencyMode:!0});y.loadSource(a.url),y.attachMedia(t(z)),y.on(Se.Events.MANIFEST_PARSED,function(){w().autoplay&&t(z).play()}),y.on(Se.Events.ERROR,function(T,S){if(console.error("HLS error:",T,S),S.fatal)switch(S.type){case Se.ErrorTypes.NETWORK_ERROR:console.error("Fatal network error encountered, trying to recover"),y.startLoad();break;case Se.ErrorTypes.MEDIA_ERROR:console.error("Fatal media error encountered, trying to recover"),y.recoverMediaError();break;default:console.error("Fatal error, cannot recover"),y.destroy();break}}),ue=!0}else ue||(se(z,t(z).src=a.url),w().autoplay&&t(z).play(),ue=!0)}et(()=>{window.addEventListener("keydown",a=>{!t(p)||t(q)||!(t(F)&&t(F).contains(document.activeElement))||(a.key==="ArrowRight"&&R()!=="edit"?Ge(t(p),.1):a.key==="ArrowLeft"&&R()!=="edit"&&Ge(t(p),-.1))})});async function he(a,y){ne();try{let T;if(Array.isArray(y))T=y;else{const O=await(await fetch(y)).text();T=ye(O)}if(T.length>0){let S="";if(t(o)){se(o,t(o).style.display="");const O=re=>{const te=T.find(ge=>re>=ge.start&&re<=ge.end);te&&te.text!==S?(S=te.text,se(o,t(o).textContent=S)):!te&&S!==""&&(S="",se(o,t(o).textContent=""))};a.on("audioprocess",O),ce.push(()=>{a.un("audioprocess",O)})}}}catch{}}function ee(){t(o)&&se(o,t(o).style.display="none")}function ne(){t(o)&&se(o,t(o).textContent=""),ce.forEach(a=>a()),ce=[]}function ye(a){const y=a.split(`
`),T=[];for(let S=0;S<y.length;S++){const O=y[S].trim();if(O.includes(" --> ")){const[re,te]=O.split(" --> "),ge=ze(re),Me=ze(te);let oe="";for(let me=S+1;me<y.length&&y[me].trim()!=="";me++)oe&&(oe+=" "),oe+=y[me].trim();oe&&T.push({start:ge,end:Me,text:oe})}}return T}function ze(a){const y=a.split(":");if(y.length===3){const T=parseInt(y[0]),S=parseInt(y[1]),O=parseFloat(y[2]);return T*3600+S*60+O}return 0}$(()=>k(r()),()=>{L(i,r()?.url)}),$(()=>(k(_()),k(r())),()=>{L(n,_().show_recording_waveform&&!r()?.is_stream)}),$(()=>(t(n),t(x),t(p)),()=>{t(n)&&t(x)!==void 0&&t(x)!==null&&(t(p)!==void 0&&t(p).destroy(),se(x,t(x).innerHTML=""),_e(),L(C,!1))}),$(()=>(k(l()),t(p),t(de)),()=>{l()&&t(p)&&(t(de)?he(t(p),l()):ee())}),$(()=>(t(z),t(i)),()=>{t(z)&&t(i)&&be(t(i))}),$(()=>(t(z),k(r())),()=>{t(z)&&r()?.is_stream&&we(r())}),Ne();var fe={get value(){return r()},set value(a){r(a),g()},get subtitles(){return l()},set subtitles(a){l(a),g()},get label(){return u()},set label(a){u(a),g()},get i18n(){return h()},set i18n(a){h(a),g()},get dispatch_blob(){return c()},set dispatch_blob(a){c(a),g()},get interactive(){return d()},set interactive(a){d(a),g()},get editable(){return f()},set editable(a){f(a),g()},get trim_region_settings(){return E()},set trim_region_settings(a){E(a),g()},get waveform_settings(){return w()},set waveform_settings(a){w(a),g()},get waveform_options(){return _()},set waveform_options(a){_(a),g()},get mode(){return R()},set mode(a){R(a),g()},get loop(){return X()},set loop(a){X(a),g()},get handle_reset_value(){return j()},set handle_reset_value(a){j(a),g()}};qe();var Ce=Yt(),ve=le(Ce);let We;Ee(ve,a=>L(z,a),()=>t(z));var Be=W(ve,2);{var ke=a=>{nt(a,{size:"small",children:(y,T)=>{Qe(y)},$$slots:{default:!0}})},Xe=a=>{var y=Oe(),T=le(y);{var S=O=>{var re=Xt(),te=V(re),ge=V(te);let Me;Ee(ge,N=>L(x,N),()=>t(x)),I(te);var oe=W(te,2),me=V(oe);Ee(me,N=>L(m,N),()=>t(m));var s=W(me,2),M=V(s);{var Q=N=>{var P=Nt(),G=V(P,!0);I(P),Pe(pe=>tt(G,pe),[()=>(k(Te),t(Z),J(()=>Te(t(Z))))]),D(N,P)};Y(M,N=>{R()==="edit"&&t(Z)>0&&N(Q)})}var ae=W(M,2);Ee(ae,N=>L(B,N),()=>t(B)),I(s),I(oe);var Fe=W(oe,2);Ee(Fe,N=>L(o,N),()=>t(o));var Ye=W(Fe,2);{let N=xe(()=>l()!==null);qt(Ye,{get container(){return t(x)},get waveform(){return t(p)},get playing(){return t(C)},get audio_duration(){return t(U)},get i18n(){return h()},get interactive(){return d()},handle_trim_audio:Re,get show_redo(){return d()},get handle_reset_value(){return j()},get waveform_options(){return _()},get trim_region_settings(){return E()},get editable(){return f()},get show_subtitles(){return t(N)},get mode(){return R()},set mode(P){R(P)},get trimDuration(){return t(Z)},set trimDuration(P){L(Z,P)},get show_volume_slider(){return t(q)},set show_volume_slider(P){L(q,P)},get subtitles_toggle(){return t(de)},set subtitles_toggle(P){L(de,P)},$$legacy:!0})}I(re),Ee(re,N=>L(F,N),()=>t(F)),Pe(()=>{je(re,"data-testid",u()?"waveform-"+u():"unlabelled-audio"),Me=Ke(ge,"",Me,{height:t(x)?null:"58px"})}),D(O,re)};Y(T,O=>{t(n)&&O(S)},!0)}D(a,y)};Y(Be,a=>{r()===null?a(ke):a(Xe,!1)})}return Pe(()=>{We=$e(ve,1,"standard-player svelte-1ffmt2w",null,We,{hidden:t(n)}),ve.autoplay=(k(w()),J(()=>w().autoplay))}),K("load",ve,function(a){Le.call(this,e,a)}),K("ended",ve,()=>H("stop")),K("play",ve,()=>H("play")),D(b,Ce),Ie(fe)}var Qt=ie("<!> <!>",1),Gt=ie("<!> <!>",1),Jt=ie("<!> <!>",1);function $t(b,e){Ve(e,!1);let i=v(e,"value",12,null),n=v(e,"subtitles",12,null),r=v(e,"label",12),l=v(e,"show_label",12,!0),u=v(e,"buttons",12,null),h=v(e,"i18n",12),c=v(e,"waveform_settings",28,()=>({})),d=v(e,"waveform_options",28,()=>({show_recording_waveform:!0})),f=v(e,"editable",12,!0),E=v(e,"loop",12),w=v(e,"display_icon_button_wrapper_top_corner",12,!1),_=v(e,"minimal",12,!1);const R=it();$(()=>k(i()),()=>{i()&&R("change",i())}),Ne();var X={get value(){return i()},set value(o){i(o),g()},get subtitles(){return n()},set subtitles(o){n(o),g()},get label(){return r()},set label(o){r(o),g()},get show_label(){return l()},set show_label(o){l(o),g()},get buttons(){return u()},set buttons(o){u(o),g()},get i18n(){return h()},set i18n(o){h(o),g()},get waveform_settings(){return c()},set waveform_settings(o){c(o),g()},get waveform_options(){return d()},set waveform_options(o){d(o),g()},get editable(){return f()},set editable(o){f(o),g()},get loop(){return E()},set loop(o){E(o),g()},get display_icon_button_wrapper_top_corner(){return w()},set display_icon_button_wrapper_top_corner(o){w(o),g()},get minimal(){return _()},set minimal(o){_(o),g()}};qe();var j=Jt(),x=le(j);{let o=xe(()=>(k(r()),k(h()),J(()=>r()||h()("audio.audio"))));dt(x,{get show_label(){return l()},get Icon(){return Qe},float:!1,get label(){return t(o)}})}var p=W(x,2);{var F=o=>{var m=Oe(),B=le(m);{var U=q=>{{let z=xe(()=>(k(r()),k(h()),J(()=>r()||h()("audio.audio"))));_t(q,{get value(){return i()},get label(){return t(z)},get loop(){return E()}})}},Z=q=>{var z=Gt(),ue=le(z);mt(ue,{get display_top_corner(){return w()},children:(ce,H)=>{var _e=Qt(),Re=le(_e);{var be=ee=>{{let ne=xe(()=>(k(i()),J(()=>i().is_stream?i().url?.replace("playlist.m3u8","playlist-file"):i().url))),ye=xe(()=>(k(i()),J(()=>i().orig_name||i().path)));ct(ee,{get href(){return t(ne)},get download(){return t(ye)},children:(ze,fe)=>{{let Ce=xe(()=>(k(h()),J(()=>h()("common.download"))));ht(ze,{get Icon(){return gt},get label(){return t(Ce)}})}},$$slots:{default:!0}})}};Y(Re,ee=>{k(u()),J(()=>u()===null?!0:u().includes("download"))&&ee(be)})}var we=W(Re,2);{var he=ee=>{vt(ee,{get i18n(){return h()},formatter:async ne=>ne?`<audio controls src="${await ut(ne.url)}"></audio>`:"",get value(){return i()},$$events:{error(ne){Le.call(this,e,ne)},share(ne){Le.call(this,e,ne)}}})};Y(we,ee=>{k(u()),J(()=>u()===null?!0:u().includes("share"))&&ee(he)})}D(ce,_e)},$$slots:{default:!0}});var de=W(ue,2);{let ce=xe(()=>(k(n()),J(()=>Array.isArray(n())?n():n()?.url)));Kt(de,{get value(){return i()},get subtitles(){return t(ce)},get label(){return r()},get i18n(){return h()},get waveform_settings(){return c()},get waveform_options(){return d()},get editable(){return f()},get loop(){return E()},$$events:{pause(H){Le.call(this,e,H)},play(H){Le.call(this,e,H)},stop(H){Le.call(this,e,H)},load(H){Le.call(this,e,H)}}})}D(q,z)};Y(B,q=>{_()?q(U):q(Z,!1)})}D(o,m)},C=o=>{nt(o,{size:"small",children:(m,B)=>{Qe(m)},$$slots:{default:!0}})};Y(p,o=>{i()!==null?o(F):o(C,!1)})}return D(b,j),Ie(X)}const _i=Object.freeze(Object.defineProperty({__proto__:null,default:$t},Symbol.toStringTag,{value:"Module"}));export{Kt as A,$t as S,qt as W,_i as a};
